"use strict";
/**
 * 認証バリデーションユーティリティ
 * 入力値検証とエラーハンドリングを統一
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateAuthCredentials = validateAuthCredentials;
exports.createAuthError = createAuthError;
exports.getLocalizedErrorMessage = getLocalizedErrorMessage;
// バリデーションルール
const VALIDATION_RULES = {
    USERNAME: {
        MIN_LENGTH: 1,
        MAX_LENGTH: 50,
        PATTERN: /^[a-zA-Z0-9]+$/
    },
    PASSWORD: {
        MIN_LENGTH: 1,
        MAX_LENGTH: 100
    }
};
/**
 * 認証情報の包括的バリデーション
 */
function validateAuthCredentials(credentials) {
    const errors = [];
    // ユーザー名検証
    const usernameErrors = validateUsername(credentials.username);
    errors.push(...usernameErrors);
    // パスワード検証
    const passwordErrors = validatePassword(credentials.password);
    errors.push(...passwordErrors);
    return {
        isValid: errors.length === 0,
        errors
    };
}
/**
 * ユーザー名バリデーション
 */
function validateUsername(username) {
    const errors = [];
    if (!username || username.trim().length === 0) {
        errors.push('ユーザー名を入力してください');
        return errors;
    }
    const trimmedUsername = username.trim();
    if (trimmedUsername.length < VALIDATION_RULES.USERNAME.MIN_LENGTH) {
        errors.push(`ユーザー名は${VALIDATION_RULES.USERNAME.MIN_LENGTH}文字以上で入力してください`);
    }
    if (trimmedUsername.length > VALIDATION_RULES.USERNAME.MAX_LENGTH) {
        errors.push(`ユーザー名は${VALIDATION_RULES.USERNAME.MAX_LENGTH}文字以内で入力してください`);
    }
    if (!VALIDATION_RULES.USERNAME.PATTERN.test(trimmedUsername)) {
        errors.push('ユーザー名は英数字のみ使用可能です');
    }
    return errors;
}
/**
 * パスワードバリデーション
 */
function validatePassword(password) {
    const errors = [];
    if (!password || password.length === 0) {
        errors.push('パスワードを入力してください');
        return errors;
    }
    if (password.length < VALIDATION_RULES.PASSWORD.MIN_LENGTH) {
        errors.push(`パスワードは${VALIDATION_RULES.PASSWORD.MIN_LENGTH}文字以上で入力してください`);
    }
    if (password.length > VALIDATION_RULES.PASSWORD.MAX_LENGTH) {
        errors.push(`パスワードは${VALIDATION_RULES.PASSWORD.MAX_LENGTH}文字以内で入力してください`);
    }
    return errors;
}
/**
 * 認証エラーの標準化
 */
function createAuthError(message, code) {
    return {
        message,
        code
    };
}
/**
 * エラーメッセージの国際化対応
 */
function getLocalizedErrorMessage(error) {
    const errorMessages = {
        'INVALID_CREDENTIALS': 'ユーザー名またはパスワードが正しくありません',
        'NETWORK_ERROR': 'ネットワークエラーが発生しました',
        'SERVER_ERROR': 'サーバーエラーが発生しました',
        'VALIDATION_ERROR': '入力値に誤りがあります'
    };
    return error.code && errorMessages[error.code]
        ? errorMessages[error.code]
        : error.message;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0aFZhbGlkYXRpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhdXRoVmFsaWRhdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOztBQW9CSCwwREFlQztBQXVERCwwQ0FLQztBQUtELDREQVdDO0FBM0dELGFBQWE7QUFDYixNQUFNLGdCQUFnQixHQUFHO0lBQ3ZCLFFBQVEsRUFBRTtRQUNSLFVBQVUsRUFBRSxDQUFDO1FBQ2IsVUFBVSxFQUFFLEVBQUU7UUFDZCxPQUFPLEVBQUUsZ0JBQWdCO0tBQzFCO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsVUFBVSxFQUFFLENBQUM7UUFDYixVQUFVLEVBQUUsR0FBRztLQUNoQjtDQUNPLENBQUM7QUFFWDs7R0FFRztBQUNILFNBQWdCLHVCQUF1QixDQUFDLFdBQTRCO0lBQ2xFLE1BQU0sTUFBTSxHQUFhLEVBQUUsQ0FBQztJQUU1QixVQUFVO0lBQ1YsTUFBTSxjQUFjLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzlELE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxjQUFjLENBQUMsQ0FBQztJQUUvQixVQUFVO0lBQ1YsTUFBTSxjQUFjLEdBQUcsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzlELE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxjQUFjLENBQUMsQ0FBQztJQUUvQixPQUFPO1FBQ0wsT0FBTyxFQUFFLE1BQU0sQ0FBQyxNQUFNLEtBQUssQ0FBQztRQUM1QixNQUFNO0tBQ1AsQ0FBQztBQUNKLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsZ0JBQWdCLENBQUMsUUFBZ0I7SUFDeEMsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO0lBRTVCLElBQUksQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUM5QyxNQUFNLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDOUIsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVELE1BQU0sZUFBZSxHQUFHLFFBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUV4QyxJQUFJLGVBQWUsQ0FBQyxNQUFNLEdBQUcsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ2xFLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsVUFBVSxlQUFlLENBQUMsQ0FBQztJQUM1RSxDQUFDO0lBRUQsSUFBSSxlQUFlLENBQUMsTUFBTSxHQUFHLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNsRSxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLFVBQVUsZUFBZSxDQUFDLENBQUM7SUFDNUUsQ0FBQztJQUVELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDO1FBQzdELE1BQU0sQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBRUQsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQztBQUVEOztHQUVHO0FBQ0gsU0FBUyxnQkFBZ0IsQ0FBQyxRQUFnQjtJQUN4QyxNQUFNLE1BQU0sR0FBYSxFQUFFLENBQUM7SUFFNUIsSUFBSSxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUM5QixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUQsSUFBSSxRQUFRLENBQUMsTUFBTSxHQUFHLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUMzRCxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLFVBQVUsZUFBZSxDQUFDLENBQUM7SUFDNUUsQ0FBQztJQUVELElBQUksUUFBUSxDQUFDLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDM0QsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxVQUFVLGVBQWUsQ0FBQyxDQUFDO0lBQzVFLENBQUM7SUFFRCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixlQUFlLENBQUMsT0FBZSxFQUFFLElBQWE7SUFDNUQsT0FBTztRQUNMLE9BQU87UUFDUCxJQUFJO0tBQ0wsQ0FBQztBQUNKLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLHdCQUF3QixDQUFDLEtBQWdCO0lBQ3ZELE1BQU0sYUFBYSxHQUEyQjtRQUM1QyxxQkFBcUIsRUFBRSx3QkFBd0I7UUFDL0MsZUFBZSxFQUFFLGtCQUFrQjtRQUNuQyxjQUFjLEVBQUUsZ0JBQWdCO1FBQ2hDLGtCQUFrQixFQUFFLGFBQWE7S0FDbEMsQ0FBQztJQUVGLE9BQU8sS0FBSyxDQUFDLElBQUksSUFBSSxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztRQUM1QyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUM7UUFDM0IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUM7QUFDcEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog6KqN6Ki844OQ44Oq44OH44O844K344On44Oz44Om44O844OG44Kj44Oq44OG44KjXG4gKiDlhaXlipvlgKTmpJzoqLzjgajjgqjjg6njg7zjg4/jg7Pjg4njg6rjg7PjgrDjgpLntbHkuIBcbiAqL1xuXG5pbXBvcnQgeyBBdXRoQ3JlZGVudGlhbHMsIFZhbGlkYXRpb25SZXN1bHQsIEF1dGhFcnJvciB9IGZyb20gJy4uL3R5cGVzL2F1dGgnO1xuXG4vLyDjg5Djg6rjg4fjg7zjgrfjg6fjg7Pjg6vjg7zjg6tcbmNvbnN0IFZBTElEQVRJT05fUlVMRVMgPSB7XG4gIFVTRVJOQU1FOiB7XG4gICAgTUlOX0xFTkdUSDogMSxcbiAgICBNQVhfTEVOR1RIOiA1MCxcbiAgICBQQVRURVJOOiAvXlthLXpBLVowLTldKyQvXG4gIH0sXG4gIFBBU1NXT1JEOiB7XG4gICAgTUlOX0xFTkdUSDogMSxcbiAgICBNQVhfTEVOR1RIOiAxMDBcbiAgfVxufSBhcyBjb25zdDtcblxuLyoqXG4gKiDoqo3oqLzmg4XloLHjga7ljIXmi6znmoTjg5Djg6rjg4fjg7zjgrfjg6fjg7NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQXV0aENyZWRlbnRpYWxzKGNyZWRlbnRpYWxzOiBBdXRoQ3JlZGVudGlhbHMpOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIC8vIOODpuODvOOCtuODvOWQjeaknOiovFxuICBjb25zdCB1c2VybmFtZUVycm9ycyA9IHZhbGlkYXRlVXNlcm5hbWUoY3JlZGVudGlhbHMudXNlcm5hbWUpO1xuICBlcnJvcnMucHVzaCguLi51c2VybmFtZUVycm9ycyk7XG5cbiAgLy8g44OR44K544Ov44O844OJ5qSc6Ki8XG4gIGNvbnN0IHBhc3N3b3JkRXJyb3JzID0gdmFsaWRhdGVQYXNzd29yZChjcmVkZW50aWFscy5wYXNzd29yZCk7XG4gIGVycm9ycy5wdXNoKC4uLnBhc3N3b3JkRXJyb3JzKTtcblxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzXG4gIH07XG59XG5cbi8qKlxuICog44Om44O844K244O85ZCN44OQ44Oq44OH44O844K344On44OzXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlVXNlcm5hbWUodXNlcm5hbWU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIGlmICghdXNlcm5hbWUgfHwgdXNlcm5hbWUudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgIGVycm9ycy5wdXNoKCfjg6bjg7zjgrbjg7zlkI3jgpLlhaXlipvjgZfjgabjgY/jgaDjgZXjgYQnKTtcbiAgICByZXR1cm4gZXJyb3JzO1xuICB9XG5cbiAgY29uc3QgdHJpbW1lZFVzZXJuYW1lID0gdXNlcm5hbWUudHJpbSgpO1xuXG4gIGlmICh0cmltbWVkVXNlcm5hbWUubGVuZ3RoIDwgVkFMSURBVElPTl9SVUxFUy5VU0VSTkFNRS5NSU5fTEVOR1RIKSB7XG4gICAgZXJyb3JzLnB1c2goYOODpuODvOOCtuODvOWQjeOBryR7VkFMSURBVElPTl9SVUxFUy5VU0VSTkFNRS5NSU5fTEVOR1RIfeaWh+Wtl+S7peS4iuOBp+WFpeWKm+OBl+OBpuOBj+OBoOOBleOBhGApO1xuICB9XG5cbiAgaWYgKHRyaW1tZWRVc2VybmFtZS5sZW5ndGggPiBWQUxJREFUSU9OX1JVTEVTLlVTRVJOQU1FLk1BWF9MRU5HVEgpIHtcbiAgICBlcnJvcnMucHVzaChg44Om44O844K244O85ZCN44GvJHtWQUxJREFUSU9OX1JVTEVTLlVTRVJOQU1FLk1BWF9MRU5HVEh95paH5a2X5Lul5YaF44Gn5YWl5Yqb44GX44Gm44GP44Gg44GV44GEYCk7XG4gIH1cblxuICBpZiAoIVZBTElEQVRJT05fUlVMRVMuVVNFUk5BTUUuUEFUVEVSTi50ZXN0KHRyaW1tZWRVc2VybmFtZSkpIHtcbiAgICBlcnJvcnMucHVzaCgn44Om44O844K244O85ZCN44Gv6Iux5pWw5a2X44Gu44G/5L2/55So5Y+v6IO944Gn44GZJyk7XG4gIH1cblxuICByZXR1cm4gZXJyb3JzO1xufVxuXG4vKipcbiAqIOODkeOCueODr+ODvOODieODkOODquODh+ODvOOCt+ODp+ODs1xuICovXG5mdW5jdGlvbiB2YWxpZGF0ZVBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcblxuICBpZiAoIXBhc3N3b3JkIHx8IHBhc3N3b3JkLmxlbmd0aCA9PT0gMCkge1xuICAgIGVycm9ycy5wdXNoKCfjg5Hjgrnjg6/jg7zjg4njgpLlhaXlipvjgZfjgabjgY/jgaDjgZXjgYQnKTtcbiAgICByZXR1cm4gZXJyb3JzO1xuICB9XG5cbiAgaWYgKHBhc3N3b3JkLmxlbmd0aCA8IFZBTElEQVRJT05fUlVMRVMuUEFTU1dPUkQuTUlOX0xFTkdUSCkge1xuICAgIGVycm9ycy5wdXNoKGDjg5Hjgrnjg6/jg7zjg4njga8ke1ZBTElEQVRJT05fUlVMRVMuUEFTU1dPUkQuTUlOX0xFTkdUSH3mloflrZfku6XkuIrjgaflhaXlipvjgZfjgabjgY/jgaDjgZXjgYRgKTtcbiAgfVxuXG4gIGlmIChwYXNzd29yZC5sZW5ndGggPiBWQUxJREFUSU9OX1JVTEVTLlBBU1NXT1JELk1BWF9MRU5HVEgpIHtcbiAgICBlcnJvcnMucHVzaChg44OR44K544Ov44O844OJ44GvJHtWQUxJREFUSU9OX1JVTEVTLlBBU1NXT1JELk1BWF9MRU5HVEh95paH5a2X5Lul5YaF44Gn5YWl5Yqb44GX44Gm44GP44Gg44GV44GEYCk7XG4gIH1cblxuICByZXR1cm4gZXJyb3JzO1xufVxuXG4vKipcbiAqIOiqjeiovOOCqOODqeODvOOBruaomea6luWMllxuICovXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQXV0aEVycm9yKG1lc3NhZ2U6IHN0cmluZywgY29kZT86IHN0cmluZyk6IEF1dGhFcnJvciB7XG4gIHJldHVybiB7XG4gICAgbWVzc2FnZSxcbiAgICBjb2RlXG4gIH07XG59XG5cbi8qKlxuICog44Ko44Op44O844Oh44OD44K744O844K444Gu5Zu96Zqb5YyW5a++5b+cXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb2NhbGl6ZWRFcnJvck1lc3NhZ2UoZXJyb3I6IEF1dGhFcnJvcik6IHN0cmluZyB7XG4gIGNvbnN0IGVycm9yTWVzc2FnZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgJ0lOVkFMSURfQ1JFREVOVElBTFMnOiAn44Om44O844K244O85ZCN44G+44Gf44Gv44OR44K544Ov44O844OJ44GM5q2j44GX44GP44GC44KK44G+44Gb44KTJyxcbiAgICAnTkVUV09SS19FUlJPUic6ICfjg43jg4Pjg4jjg6/jg7zjgq/jgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ8nLFxuICAgICdTRVJWRVJfRVJST1InOiAn44K144O844OQ44O844Ko44Op44O844GM55m655Sf44GX44G+44GX44GfJyxcbiAgICAnVkFMSURBVElPTl9FUlJPUic6ICflhaXlipvlgKTjgavoqqTjgorjgYzjgYLjgorjgb7jgZknXG4gIH07XG5cbiAgcmV0dXJuIGVycm9yLmNvZGUgJiYgZXJyb3JNZXNzYWdlc1tlcnJvci5jb2RlXSBcbiAgICA/IGVycm9yTWVzc2FnZXNbZXJyb3IuY29kZV0gXG4gICAgOiBlcnJvci5tZXNzYWdlO1xufSJdfQ==