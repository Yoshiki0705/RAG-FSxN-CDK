"use strict";
/**
 * サインイン機能のカスタムフック
 * 認証ロジックとステート管理を分離
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.useSignIn = useSignIn;
const react_1 = require("react");
const navigation_1 = require("next/navigation");
// 認証設定の定数化
const AUTH_CONFIG = {
    VALID_USERS: [
        'testuser',
        'admin',
        ...Array.from({ length: 50 }, (_, i) => `testuser${i}`)
    ],
    DEFAULT_PASSWORD: 'password',
    REDIRECT_PATH: '/chatbot',
    STORAGE_KEY: 'user'
};
function useSignIn() {
    const [isLoading, setIsLoading] = (0, react_1.useState)(false);
    const [error, setError] = (0, react_1.useState)('');
    const router = (0, navigation_1.useRouter)();
    const signIn = async (username, password) => {
        setIsLoading(true);
        setError('');
        try {
            // 入力値検証
            const validationError = validateCredentials(username, password);
            if (validationError) {
                throw new Error(validationError);
            }
            // 認証処理
            if (isValidCredentials(username, password)) {
                // セッション情報保存
                saveUserSession(username);
                // リダイレクト
                router.push(AUTH_CONFIG.REDIRECT_PATH);
            }
            else {
                throw new Error('ユーザー名またはパスワードが正しくありません');
            }
        }
        catch (err) {
            const errorMessage = err instanceof Error ? err.message : 'サインインに失敗しました';
            setError(errorMessage);
        }
        finally {
            setIsLoading(false);
        }
    };
    const clearError = () => {
        setError('');
    };
    return {
        isLoading,
        error,
        signIn,
        clearError
    };
}
/**
 * 入力値検証
 */
function validateCredentials(username, password) {
    if (!username.trim()) {
        return 'ユーザー名を入力してください';
    }
    if (!password.trim()) {
        return 'パスワードを入力してください';
    }
    if (username.length > 50) {
        return 'ユーザー名は50文字以内で入力してください';
    }
    return null;
}
/**
 * 認証情報検証
 */
function isValidCredentials(username, password) {
    return AUTH_CONFIG.VALID_USERS.includes(username) &&
        password === AUTH_CONFIG.DEFAULT_PASSWORD;
}
/**
 * ユーザーセッション保存
 */
function saveUserSession(username) {
    const userSession = {
        username,
        signInTime: new Date().toISOString()
    };
    localStorage.setItem(AUTH_CONFIG.STORAGE_KEY, JSON.stringify(userSession));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlU2lnbkluLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidXNlU2lnbkluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBMkJILDhCQTRDQztBQXJFRCxpQ0FBaUM7QUFDakMsZ0RBQTRDO0FBRTVDLFdBQVc7QUFDWCxNQUFNLFdBQVcsR0FBRztJQUNsQixXQUFXLEVBQUU7UUFDWCxVQUFVO1FBQ1YsT0FBTztRQUNQLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUM7S0FDeEQ7SUFDRCxnQkFBZ0IsRUFBRSxVQUFVO0lBQzVCLGFBQWEsRUFBRSxVQUFVO0lBQ3pCLFdBQVcsRUFBRSxNQUFNO0NBQ1gsQ0FBQztBQVlYLFNBQWdCLFNBQVM7SUFDdkIsTUFBTSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDbEQsTUFBTSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsRUFBRSxDQUFDLENBQUM7SUFDdkMsTUFBTSxNQUFNLEdBQUcsSUFBQSxzQkFBUyxHQUFFLENBQUM7SUFFM0IsTUFBTSxNQUFNLEdBQUcsS0FBSyxFQUFFLFFBQWdCLEVBQUUsUUFBZ0IsRUFBaUIsRUFBRTtRQUN6RSxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkIsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBRWIsSUFBSSxDQUFDO1lBQ0gsUUFBUTtZQUNSLE1BQU0sZUFBZSxHQUFHLG1CQUFtQixDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUNoRSxJQUFJLGVBQWUsRUFBRSxDQUFDO2dCQUNwQixNQUFNLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ25DLENBQUM7WUFFRCxPQUFPO1lBQ1AsSUFBSSxrQkFBa0IsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQztnQkFDM0MsWUFBWTtnQkFDWixlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBRTFCLFNBQVM7Z0JBQ1QsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDekMsQ0FBQztpQkFBTSxDQUFDO2dCQUNOLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLENBQUMsQ0FBQztZQUM1QyxDQUFDO1FBQ0gsQ0FBQztRQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7WUFDYixNQUFNLFlBQVksR0FBRyxHQUFHLFlBQVksS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxjQUFjLENBQUM7WUFDekUsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3pCLENBQUM7Z0JBQVMsQ0FBQztZQUNULFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN0QixDQUFDO0lBQ0gsQ0FBQyxDQUFDO0lBRUYsTUFBTSxVQUFVLEdBQUcsR0FBUyxFQUFFO1FBQzVCLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNmLENBQUMsQ0FBQztJQUVGLE9BQU87UUFDTCxTQUFTO1FBQ1QsS0FBSztRQUNMLE1BQU07UUFDTixVQUFVO0tBQ1gsQ0FBQztBQUNKLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsbUJBQW1CLENBQUMsUUFBZ0IsRUFBRSxRQUFnQjtJQUM3RCxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUM7UUFDckIsT0FBTyxnQkFBZ0IsQ0FBQztJQUMxQixDQUFDO0lBRUQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO1FBQ3JCLE9BQU8sZ0JBQWdCLENBQUM7SUFDMUIsQ0FBQztJQUVELElBQUksUUFBUSxDQUFDLE1BQU0sR0FBRyxFQUFFLEVBQUUsQ0FBQztRQUN6QixPQUFPLHVCQUF1QixDQUFDO0lBQ2pDLENBQUM7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsa0JBQWtCLENBQUMsUUFBZ0IsRUFBRSxRQUFnQjtJQUM1RCxPQUFPLFdBQVcsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQztRQUMxQyxRQUFRLEtBQUssV0FBVyxDQUFDLGdCQUFnQixDQUFDO0FBQ25ELENBQUM7QUFFRDs7R0FFRztBQUNILFNBQVMsZUFBZSxDQUFDLFFBQWdCO0lBQ3ZDLE1BQU0sV0FBVyxHQUFHO1FBQ2xCLFFBQVE7UUFDUixVQUFVLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7S0FDckMsQ0FBQztJQUVGLFlBQVksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7QUFDN0UsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog44K144Kk44Oz44Kk44Oz5qmf6IO944Gu44Kr44K544K/44Og44OV44OD44KvXG4gKiDoqo3oqLzjg63jgrjjg4Pjgq/jgajjgrnjg4bjg7zjg4jnrqHnkIbjgpLliIbpm6JcbiAqL1xuXG5pbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvbmF2aWdhdGlvbic7XG5cbi8vIOiqjeiovOioreWumuOBruWumuaVsOWMllxuY29uc3QgQVVUSF9DT05GSUcgPSB7XG4gIFZBTElEX1VTRVJTOiBbXG4gICAgJ3Rlc3R1c2VyJyxcbiAgICAnYWRtaW4nLFxuICAgIC4uLkFycmF5LmZyb20oeyBsZW5ndGg6IDUwIH0sIChfLCBpKSA9PiBgdGVzdHVzZXIke2l9YClcbiAgXSxcbiAgREVGQVVMVF9QQVNTV09SRDogJ3Bhc3N3b3JkJyxcbiAgUkVESVJFQ1RfUEFUSDogJy9jaGF0Ym90JyxcbiAgU1RPUkFHRV9LRVk6ICd1c2VyJ1xufSBhcyBjb25zdDtcblxuaW50ZXJmYWNlIFNpZ25JblN0YXRlIHtcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xuICBlcnJvcjogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU2lnbkluQWN0aW9ucyB7XG4gIHNpZ25JbjogKHVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG4gIGNsZWFyRXJyb3I6ICgpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VTaWduSW4oKTogU2lnbkluU3RhdGUgJiBTaWduSW5BY3Rpb25zIHtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZSgnJyk7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuXG4gIGNvbnN0IHNpZ25JbiA9IGFzeW5jICh1c2VybmFtZTogc3RyaW5nLCBwYXNzd29yZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgIHNldEVycm9yKCcnKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyDlhaXlipvlgKTmpJzoqLxcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvciA9IHZhbGlkYXRlQ3JlZGVudGlhbHModXNlcm5hbWUsIHBhc3N3b3JkKTtcbiAgICAgIGlmICh2YWxpZGF0aW9uRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHZhbGlkYXRpb25FcnJvcik7XG4gICAgICB9XG5cbiAgICAgIC8vIOiqjeiovOWHpueQhlxuICAgICAgaWYgKGlzVmFsaWRDcmVkZW50aWFscyh1c2VybmFtZSwgcGFzc3dvcmQpKSB7XG4gICAgICAgIC8vIOOCu+ODg+OCt+ODp+ODs+aDheWgseS/neWtmFxuICAgICAgICBzYXZlVXNlclNlc3Npb24odXNlcm5hbWUpO1xuICAgICAgICBcbiAgICAgICAgLy8g44Oq44OA44Kk44Os44Kv44OIXG4gICAgICAgIHJvdXRlci5wdXNoKEFVVEhfQ09ORklHLlJFRElSRUNUX1BBVEgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCfjg6bjg7zjgrbjg7zlkI3jgb7jgZ/jga/jg5Hjgrnjg6/jg7zjg4njgYzmraPjgZfjgY/jgYLjgorjgb7jgZvjgpMnKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAn44K144Kk44Oz44Kk44Oz44Gr5aSx5pWX44GX44G+44GX44GfJztcbiAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGNsZWFyRXJyb3IgPSAoKTogdm9pZCA9PiB7XG4gICAgc2V0RXJyb3IoJycpO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgaXNMb2FkaW5nLFxuICAgIGVycm9yLFxuICAgIHNpZ25JbixcbiAgICBjbGVhckVycm9yXG4gIH07XG59XG5cbi8qKlxuICog5YWl5Yqb5YCk5qSc6Ki8XG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlQ3JlZGVudGlhbHModXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICBpZiAoIXVzZXJuYW1lLnRyaW0oKSkge1xuICAgIHJldHVybiAn44Om44O844K244O85ZCN44KS5YWl5Yqb44GX44Gm44GP44Gg44GV44GEJztcbiAgfVxuICBcbiAgaWYgKCFwYXNzd29yZC50cmltKCkpIHtcbiAgICByZXR1cm4gJ+ODkeOCueODr+ODvOODieOCkuWFpeWKm+OBl+OBpuOBj+OBoOOBleOBhCc7XG4gIH1cbiAgXG4gIGlmICh1c2VybmFtZS5sZW5ndGggPiA1MCkge1xuICAgIHJldHVybiAn44Om44O844K244O85ZCN44GvNTDmloflrZfku6XlhoXjgaflhaXlipvjgZfjgabjgY/jgaDjgZXjgYQnO1xuICB9XG4gIFxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiDoqo3oqLzmg4XloLHmpJzoqLxcbiAqL1xuZnVuY3Rpb24gaXNWYWxpZENyZWRlbnRpYWxzKHVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIEFVVEhfQ09ORklHLlZBTElEX1VTRVJTLmluY2x1ZGVzKHVzZXJuYW1lKSAmJiBcbiAgICAgICAgIHBhc3N3b3JkID09PSBBVVRIX0NPTkZJRy5ERUZBVUxUX1BBU1NXT1JEO1xufVxuXG4vKipcbiAqIOODpuODvOOCtuODvOOCu+ODg+OCt+ODp+ODs+S/neWtmFxuICovXG5mdW5jdGlvbiBzYXZlVXNlclNlc3Npb24odXNlcm5hbWU6IHN0cmluZyk6IHZvaWQge1xuICBjb25zdCB1c2VyU2Vzc2lvbiA9IHtcbiAgICB1c2VybmFtZSxcbiAgICBzaWduSW5UaW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgfTtcbiAgXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKEFVVEhfQ09ORklHLlNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeSh1c2VyU2Vzc2lvbikpO1xufSJdfQ==